<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Integration Testing with Golang | harrigan.xyz</title><meta name=keywords content="go,development,testing"><meta name=description content="How to create integration tests with Golang"><meta name=author content="David Harrigan"><link rel=canonical href=https://harrigan.xyz/posts/integration-testing-with-golang/><link crossorigin=anonymous href=/assets/css/stylesheet.080efc7c8bc572aea814ec36cb3373874f8a9647ab5fb728951b6720596d4f3d.css integrity="sha256-CA78fIvFcq6oFOw2yzNzh0+KlkerX7colRtnIFltTz0=" rel="preload stylesheet" as=style><link rel=icon href=https://harrigan.xyz/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://harrigan.xyz/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://harrigan.xyz/favicon-32x32.png><link rel=apple-touch-icon href=https://harrigan.xyz/apple-touch-icon.png><link rel=mask-icon href=https://harrigan.xyz/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-117782664-1","auto"),ga("send","pageview"))</script><meta property="og:title" content="Integration Testing with Golang"><meta property="og:description" content="How to create integration tests with Golang"><meta property="og:type" content="article"><meta property="og:url" content="https://harrigan.xyz/posts/integration-testing-with-golang/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-09-14T00:00:00+00:00"><meta property="article:modified_time" content="2019-09-14T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Integration Testing with Golang"><meta name=twitter:description content="How to create integration tests with Golang"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://harrigan.xyz/posts/"},{"@type":"ListItem","position":2,"name":"Integration Testing with Golang","item":"https://harrigan.xyz/posts/integration-testing-with-golang/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Integration Testing with Golang","name":"Integration Testing with Golang","description":"How to create integration tests with Golang","keywords":["go","development","testing"],"articleBody":"At my previous job, I came to appreciate the importance of integration testing. Not only does it give us confidence (especially when weâ€™re on-call), but it continuously verified that our services were functional through automated runs from Jenkins.\nTwo of the primary languages used at the time were Go and Python. Although the majority of our services were written in Go, most of our API tests were written in Python. Writing stand-alone tests is fairly straightforward in Python. At the simplest level, you just need a single file that sets up tests, uses requests to make calls, and assert the responses.\nI wanted to know a way to do something similar in Go.\nGoals Easy to write and leverages the standard testing package. Test setup function that configures dependencies, such as client config to call services in the desired environment (local, staging, production, etc). Standalone tests that are isolated from unit tests. This is either a plus or minus depending on who you ask, I still donâ€™t know the answer ðŸ˜…. I like to think that this is a plus. Integration tests should ideally treat the target service as a black-box and simply expect some output. There are other reasons as well that we will get to in this post. A binary can be produced that can run from CI/CD. Setup To easily verify my goals, I created a very simple gRPC service that I can run against. There are two endpoints - Ping and StreamPing. Calling Ping simply replies with (you guessed it!) a pong message. StreamPing is similar, but you can specify how many times it pongâ€™s back.\nsyntax = \"proto3\"; package ping; option go_package = \"protos\"; service Pinger { rpc Ping(PingRequest) returns (PingResponse) {} rpc PingStream (PingRequest) returns (stream PingResponse) {} } message PingRequest { int32 count = 1; } message PingResponse { bytes payload = 1; } I wrote a unit test, and I also added a top-level testing package where I intend to store isolated tests. In the end, I ended on the following structure:\nâ”œâ”€â”€ Makefile â”œâ”€â”€ go.mod â”œâ”€â”€ go.sum â”œâ”€â”€ grpc â”‚Â â””â”€â”€ protos â”‚Â â”œâ”€â”€ ping.pb.go â”‚Â â””â”€â”€ ping.proto â”œâ”€â”€ service â”‚Â â”œâ”€â”€ main.go â”‚Â â””â”€â”€ pinger â”‚Â â”œâ”€â”€ pinger.go â”‚Â â””â”€â”€ pinger_test.go â””â”€â”€ testing â”œâ”€â”€ config â”‚Â â””â”€â”€ config.go â””â”€â”€ integration â””â”€â”€ pinger â”œâ”€â”€ integration_test.go â””â”€â”€ main_test.go Using the build tag Go allows you to specify build tags to consider during a build. This concept also applies to tests. This means that one way to separate unit tests from more time-consuming tests such as integration tests is to mark these files with the appropriate build tag to skip them altogether.\nMy integration_test.go file has a build tag of:\n// +build integration package pinger This allows us to skip tests in that file when I just want to run unit tests in our project.\nUsing TestMain TestMain allows us to set up the necessary setup and teardown for our test cases. This is precisely what we need to set up our clients and dependencies needed for running integration tests against any environment.\nNote that this must be placed in the same package as to where our integration tests live. This is the other reason why in this case, it is better to have a dedicated package for integration tests. The alternative is to have an init() func or have multiple TestMain for all packages with the +build integration build flag, which did not appeal to me.\nWe can also read from flag from TestMain. This allowed me to set up flags that can be specified from the command line to specify my server address and port. All of the configuration values were then saved to variables under the config package. I also added another flag, integrationLocal. If this flag is specified, it runs the server from the test, meaning I can quickly verify my service is working without having to spin up an entire local environment. We could take this a little further and inject mocks for other services that it depends on so that it can run without any dependencies.\nIn the end, this is what my main_test.go file ended looking like.\n// +build integration package pinger import ( \"flag\" \"log\" \"os\" \"testing\" \"github.com/davidharrigan/pinger/testing/config\" ) var integrationLocal = flag.Bool(\"integration-local\", false, \"spin up a local instance of pinger within the test\") var pingerAddress = flag.String(\"pinger-address\", \"localhost\", \"pinger address\") var pingerPort = flag.Int(\"pinger-port\", 50051, \"pinger port\") func TestMain(m *testing.M) { flag.Parse() if *integrationLocal { go func() { s := config.Pinger() defer s.Stop() }() } else { log.Println(\"\u003e\u003e\u003e running in integration mode\") config.PingerConfig = config.ServerConfig{ Address: *pingerAddress, Port: *pingerPort, } } os.Exit(m.Run()) } Writing integration tests Now we have all the pieces needed to use the standard testing.T to write our integration tests. The only extra step we need is to read the client configuration from our config package, but otherwise, it is as simple as writing any other Golang tests.\n// +build integration package pinger import ( \"context\" \"fmt\" \"io\" \"testing\" \"time\" \"github.com/stretchr/testify/assert\" \"google.golang.org/grpc\" pb \"github.com/davidharrigan/pinger/grpc/protos\" \"github.com/davidharrigan/pinger/testing/config\" ) func address() string { return fmt.Sprintf(\"%s:%d\", config.PingerConfig.Address, config.PingerConfig.Port) } func TestPinger(t *testing.T) { type expectation struct { out *pb.PingResponse err error } tcs := map[string]struct { in *pb.PingRequest expected expectation }{ \"ok\": { in: \u0026pb.PingRequest{}, expected: expectation{ out: \u0026pb.PingResponse{ Payload: []byte(`pong`), }, }, }, } for scenario, tc := range tcs { t.Run(scenario, func(t *testing.T) { assert := assert.New(t) conn, err := grpc.Dial(address(), grpc.WithInsecure()) assert.Nil(err) defer conn.Close() c := pb.NewPingerClient(conn) ctx, cancel := context.WithTimeout(context.Background(), time.Second) defer cancel() out, err := c.Ping(ctx, tc.in) assert.Nil(err) if tc.expected.err == nil { assert.Nil(err) assert.Equal(tc.expected.out, out) } else { assert.Nil(out) assert.Equal(tc.expected.err, err) } }) } } Compiling the test binary Now, the only thing left for us to do is produce a binary of integration tests. We can specify the -c flag from go test to compile the test binary without running it:\ngo test -tags integration -c ./testing/integration/... This is another case why having integration tests isolated works out well. Our binary only contains the integration tests.\nConclusion I hope you found this writeup useful. I believe we managed to accomplish all the goals I proposed in the beginning. I would love to know other approaches that are out there that accomplishes something similar or any drawbacks to the one I presented here. If you would like the see the full source of this testing setup, you can check it out here.\n","wordCount":"1063","inLanguage":"en","datePublished":"2019-09-14T00:00:00Z","dateModified":"2019-09-14T00:00:00Z","author":{"@type":"Person","name":"David Harrigan"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://harrigan.xyz/posts/integration-testing-with-golang/"},"publisher":{"@type":"Organization","name":"harrigan.xyz","logo":{"@type":"ImageObject","url":"https://harrigan.xyz/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://harrigan.xyz/ accesskey=h title="harrigan.xyz (Alt + H)">harrigan.xyz</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://harrigan.xyz/archives title=Archive><span>Archive</span></a></li><li><a href=https://harrigan.xyz/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://harrigan.xyz/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://harrigan.xyz/>Home</a>&nbsp;Â»&nbsp;<a href=https://harrigan.xyz/posts/>Posts</a></div><h1 class=post-title>Integration Testing with Golang</h1><div class=post-description>How to create integration tests with Golang</div><div class=post-meta><span title='2019-09-14 00:00:00 +0000 UTC'>September 14, 2019</span>&nbsp;Â·&nbsp;5 min&nbsp;Â·&nbsp;David Harrigan&nbsp;|&nbsp;<a href=https://github.com/davidharrigan/davidharrigan.github.io/tree/main/content/posts/2019-09-14-go-integration-testing.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#goals aria-label=Goals>Goals</a></li><li><a href=#setup aria-label=Setup>Setup</a></li><li><a href=#using-the-build-tag aria-label="Using the build tag">Using the build tag</a></li><li><a href=#using-testmain aria-label="Using TestMain">Using <code>TestMain</code></a></li><li><a href=#writing-integration-tests aria-label="Writing integration tests">Writing integration tests</a></li><li><a href=#compiling-the-test-binary aria-label="Compiling the test binary">Compiling the test binary</a></li><li><a href=#conclusion aria-label=Conclusion>Conclusion</a></li></ul></div></details></div><div class=post-content><p>At my previous job, I came to appreciate the importance of integration
testing. Not only does it give us confidence (especially when weâ€™re on-call),
but it continuously verified that our services were functional through
automated runs from Jenkins.</p><p>Two of the primary languages used at the time were Go and Python. Although
the majority of our services were written in Go, most of our API tests were
written in Python. Writing stand-alone tests is fairly straightforward in
Python. At the simplest level, you just need a single file that sets up
tests, uses <code>requests</code> to make calls, and assert the responses.</p><p>I wanted to know a way to do something similar in Go.</p><h2 id=goals>Goals<a hidden class=anchor aria-hidden=true href=#goals>#</a></h2><ul><li>Easy to write and leverages the standard <code>testing</code> package.</li><li>Test setup function that configures dependencies, such as
client config to call services in the desired environment (local, staging,
production, etc).</li><li>Standalone tests that are isolated from unit tests. This is either a plus
or minus depending on who you ask, I still don&rsquo;t know the answer ðŸ˜…. I like
to think that this is a plus. Integration tests should ideally treat the
target service as a black-box and simply expect some output. There are other
reasons as well that we will get to in this post.</li><li>A binary can be produced that can run from CI/CD.</li></ul><h2 id=setup>Setup<a hidden class=anchor aria-hidden=true href=#setup>#</a></h2><p>To easily verify my goals, I created a very simple gRPC service that
I can run against. There are two endpoints - <code>Ping</code> and <code>StreamPing</code>. Calling
<code>Ping</code> simply replies with (you guessed it!) a <code>pong</code> message. <code>StreamPing</code>
is similar, but you can specify how many times it <code>pong</code>&rsquo;s back.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-protobuf data-lang=protobuf><span class=line><span class=cl><span class=n>syntax</span> <span class=o>=</span> <span class=s>&#34;proto3&#34;</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=kn>package</span> <span class=nn>ping</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>option</span> <span class=n>go_package</span> <span class=o>=</span> <span class=s>&#34;protos&#34;</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=kd>service</span> <span class=n>Pinger</span> <span class=p>{</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>rpc</span> <span class=n>Ping</span><span class=p>(</span><span class=n>PingRequest</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=n>PingResponse</span><span class=p>)</span> <span class=p>{}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>rpc</span> <span class=n>PingStream</span> <span class=p>(</span><span class=n>PingRequest</span><span class=p>)</span> <span class=k>returns</span> <span class=p>(</span><span class=n>stream</span> <span class=n>PingResponse</span><span class=p>)</span> <span class=p>{}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=kd>message</span> <span class=nc>PingRequest</span> <span class=p>{</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=kt>int32</span> <span class=n>count</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>}</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=kd>message</span> <span class=nc>PingResponse</span> <span class=p>{</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=kt>bytes</span> <span class=n>payload</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=p>}</span><span class=err>
</span></span></span></code></pre></div><p>I wrote a unit test, and I also added a top-level <code>testing</code> package where I intend to store isolated tests. In the end, I ended on the following structure:</p><pre tabindex=0><code>â”œâ”€â”€ Makefile
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ grpc
â”‚Â Â  â””â”€â”€ protos
â”‚Â Â      â”œâ”€â”€ ping.pb.go
â”‚Â Â      â””â”€â”€ ping.proto
â”œâ”€â”€ service
â”‚Â Â  â”œâ”€â”€ main.go
â”‚Â Â  â””â”€â”€ pinger
â”‚Â Â      â”œâ”€â”€ pinger.go
â”‚Â Â      â””â”€â”€ pinger_test.go
â””â”€â”€ testing
    â”œâ”€â”€ config
    â”‚Â Â  â””â”€â”€ config.go
    â””â”€â”€ integration
        â””â”€â”€ pinger
            â”œâ”€â”€ integration_test.go
            â””â”€â”€ main_test.go
</code></pre><h2 id=using-the-build-tag>Using the build tag<a hidden class=anchor aria-hidden=true href=#using-the-build-tag>#</a></h2><p>Go allows you to specify build tags to consider during a build. This concept
also applies to tests. This means that one way to separate unit tests from
more time-consuming tests such as integration tests is to mark these files
with the appropriate build tag to skip them altogether.</p><p>My <code>integration_test.go</code> file has a build tag of:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// +build integration
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>pinger</span>
</span></span></code></pre></div><p>This allows us to skip tests in that file when I just want to run unit tests
in our project.</p><h2 id=using-testmain>Using <code>TestMain</code><a hidden class=anchor aria-hidden=true href=#using-testmain>#</a></h2><p><code>TestMain</code> allows us to set up the necessary setup and teardown for our test
cases. This is precisely what we need to set up our clients and dependencies
needed for running integration tests against any environment.</p><p>Note that this must be placed in the same package as to where our integration
tests live. This is the other reason why in this case, it is better to have a
dedicated package for integration tests. The alternative is to have an <code>init()</code>
func or have multiple <code>TestMain</code> for all packages with the <code>+build integration</code>
build flag, which did not appeal to me.</p><p>We can also read from <code>flag</code> from <code>TestMain</code>. This allowed me to set up flags
that can be specified from the command line to specify my server address and
port. All of the configuration values were then saved to variables under the
<code>config</code> package. I also added another flag, <code>integrationLocal</code>. If this flag
is specified, it runs the server from the test, meaning I can quickly verify
my service is working without having to spin up an entire local environment.
We could take this a little further and inject mocks for other services that
it depends on so that it can run without any dependencies.</p><p>In the end, this is what my <code>main_test.go</code> file ended looking like.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// +build integration
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>pinger</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;flag&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;testing&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/davidharrigan/pinger/testing/config&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>integrationLocal</span> <span class=p>=</span> <span class=nx>flag</span><span class=p>.</span><span class=nf>Bool</span><span class=p>(</span><span class=s>&#34;integration-local&#34;</span><span class=p>,</span> <span class=kc>false</span><span class=p>,</span> <span class=s>&#34;spin up a local instance of pinger within the test&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>pingerAddress</span> <span class=p>=</span> <span class=nx>flag</span><span class=p>.</span><span class=nf>String</span><span class=p>(</span><span class=s>&#34;pinger-address&#34;</span><span class=p>,</span> <span class=s>&#34;localhost&#34;</span><span class=p>,</span> <span class=s>&#34;pinger address&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>pingerPort</span> <span class=p>=</span> <span class=nx>flag</span><span class=p>.</span><span class=nf>Int</span><span class=p>(</span><span class=s>&#34;pinger-port&#34;</span><span class=p>,</span> <span class=mi>50051</span><span class=p>,</span> <span class=s>&#34;pinger port&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>TestMain</span><span class=p>(</span><span class=nx>m</span> <span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>M</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>flag</span><span class=p>.</span><span class=nf>Parse</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=o>*</span><span class=nx>integrationLocal</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>s</span> <span class=o>:=</span> <span class=nx>config</span><span class=p>.</span><span class=nf>Pinger</span><span class=p>()</span>
</span></span><span class=line><span class=cl>			<span class=k>defer</span> <span class=nx>s</span><span class=p>.</span><span class=nf>Stop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>		<span class=p>}()</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>log</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;&gt;&gt;&gt; running in integration mode&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=nx>config</span><span class=p>.</span><span class=nx>PingerConfig</span> <span class=p>=</span> <span class=nx>config</span><span class=p>.</span><span class=nx>ServerConfig</span><span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>Address</span><span class=p>:</span> <span class=o>*</span><span class=nx>pingerAddress</span><span class=p>,</span>
</span></span><span class=line><span class=cl>			<span class=nx>Port</span><span class=p>:</span>    <span class=o>*</span><span class=nx>pingerPort</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=nx>m</span><span class=p>.</span><span class=nf>Run</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=writing-integration-tests>Writing integration tests<a hidden class=anchor aria-hidden=true href=#writing-integration-tests>#</a></h2><p>Now we have all the pieces needed to use the standard <code>testing.T</code> to write
our integration tests. The only extra step we need is to read the client
configuration from our <code>config</code> package, but otherwise, it is as simple as
writing any other Golang tests.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// +build integration
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>pinger</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;io&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;testing&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;time&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/stretchr/testify/assert&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;google.golang.org/grpc&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>pb</span> <span class=s>&#34;github.com/davidharrigan/pinger/grpc/protos&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/davidharrigan/pinger/testing/config&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>address</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%s:%d&#34;</span><span class=p>,</span> <span class=nx>config</span><span class=p>.</span><span class=nx>PingerConfig</span><span class=p>.</span><span class=nx>Address</span><span class=p>,</span> <span class=nx>config</span><span class=p>.</span><span class=nx>PingerConfig</span><span class=p>.</span><span class=nx>Port</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>TestPinger</span><span class=p>(</span><span class=nx>t</span> <span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>T</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=kd>type</span> <span class=nx>expectation</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>out</span> <span class=o>*</span><span class=nx>pb</span><span class=p>.</span><span class=nx>PingResponse</span>
</span></span><span class=line><span class=cl>		<span class=nx>err</span> <span class=kt>error</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=nx>tcs</span> <span class=o>:=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>in</span>       <span class=o>*</span><span class=nx>pb</span><span class=p>.</span><span class=nx>PingRequest</span>
</span></span><span class=line><span class=cl>		<span class=nx>expected</span> <span class=nx>expectation</span>
</span></span><span class=line><span class=cl>	<span class=p>}{</span>
</span></span><span class=line><span class=cl>		<span class=s>&#34;ok&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>in</span><span class=p>:</span> <span class=o>&amp;</span><span class=nx>pb</span><span class=p>.</span><span class=nx>PingRequest</span><span class=p>{},</span>
</span></span><span class=line><span class=cl>			<span class=nx>expected</span><span class=p>:</span> <span class=nx>expectation</span><span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>out</span><span class=p>:</span> <span class=o>&amp;</span><span class=nx>pb</span><span class=p>.</span><span class=nx>PingResponse</span><span class=p>{</span>
</span></span><span class=line><span class=cl>					<span class=nx>Payload</span><span class=p>:</span> <span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=s>`pong`</span><span class=p>),</span>
</span></span><span class=line><span class=cl>				<span class=p>},</span>
</span></span><span class=line><span class=cl>			<span class=p>},</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>for</span> <span class=nx>scenario</span><span class=p>,</span> <span class=nx>tc</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>tcs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>t</span><span class=p>.</span><span class=nf>Run</span><span class=p>(</span><span class=nx>scenario</span><span class=p>,</span> <span class=kd>func</span><span class=p>(</span><span class=nx>t</span> <span class=o>*</span><span class=nx>testing</span><span class=p>.</span><span class=nx>T</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=nx>assert</span> <span class=o>:=</span> <span class=nx>assert</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=nx>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=nx>conn</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>grpc</span><span class=p>.</span><span class=nf>Dial</span><span class=p>(</span><span class=nf>address</span><span class=p>(),</span> <span class=nx>grpc</span><span class=p>.</span><span class=nf>WithInsecure</span><span class=p>())</span>
</span></span><span class=line><span class=cl>			<span class=nx>assert</span><span class=p>.</span><span class=nf>Nil</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>defer</span> <span class=nx>conn</span><span class=p>.</span><span class=nf>Close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=nx>c</span> <span class=o>:=</span> <span class=nx>pb</span><span class=p>.</span><span class=nf>NewPingerClient</span><span class=p>(</span><span class=nx>conn</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=nx>ctx</span><span class=p>,</span> <span class=nx>cancel</span> <span class=o>:=</span> <span class=nx>context</span><span class=p>.</span><span class=nf>WithTimeout</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nf>Background</span><span class=p>(),</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=k>defer</span> <span class=nf>cancel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=nx>out</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>c</span><span class=p>.</span><span class=nf>Ping</span><span class=p>(</span><span class=nx>ctx</span><span class=p>,</span> <span class=nx>tc</span><span class=p>.</span><span class=nx>in</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=nx>assert</span><span class=p>.</span><span class=nf>Nil</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=nx>tc</span><span class=p>.</span><span class=nx>expected</span><span class=p>.</span><span class=nx>err</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>assert</span><span class=p>.</span><span class=nf>Nil</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=nx>assert</span><span class=p>.</span><span class=nf>Equal</span><span class=p>(</span><span class=nx>tc</span><span class=p>.</span><span class=nx>expected</span><span class=p>.</span><span class=nx>out</span><span class=p>,</span> <span class=nx>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>assert</span><span class=p>.</span><span class=nf>Nil</span><span class=p>(</span><span class=nx>out</span><span class=p>)</span>
</span></span><span class=line><span class=cl>				<span class=nx>assert</span><span class=p>.</span><span class=nf>Equal</span><span class=p>(</span><span class=nx>tc</span><span class=p>.</span><span class=nx>expected</span><span class=p>.</span><span class=nx>err</span><span class=p>,</span> <span class=nx>err</span><span class=p>)</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>		<span class=p>})</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=compiling-the-test-binary>Compiling the test binary<a hidden class=anchor aria-hidden=true href=#compiling-the-test-binary>#</a></h2><p>Now, the only thing left for us to do is produce a binary of integration
tests. We can specify the <code>-c</code> flag from <code>go test</code> to compile the test binary
without running it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go <span class=nb>test</span> -tags integration -c ./testing/integration/...
</span></span></code></pre></div><p>This is another case why having integration tests isolated works out well.
Our binary only contains the integration tests.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>I hope you found this writeup useful. I believe we managed to accomplish all
the goals I proposed in the beginning. I would love to know other approaches
that are out there that accomplishes something similar or any drawbacks to
the one I presented here. If you would like the see the full source of this
testing setup, you can check it out <a href=https://github.com/davidharrigan/pinger>here</a>.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://harrigan.xyz/tags/go/>go</a></li><li><a href=https://harrigan.xyz/tags/development/>development</a></li><li><a href=https://harrigan.xyz/tags/testing/>testing</a></li></ul><nav class=paginav><a class=prev href=https://harrigan.xyz/posts/testing-go-grpc-server-using-an-in-memory-buffer-with-bufconn/><span class=title>Â« Prev</span><br><span>Testing Go gRPC Server Using an in-memory Buffer with `bufconn`</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Integration Testing with Golang on twitter" href="https://twitter.com/intent/tweet/?text=Integration%20Testing%20with%20Golang&amp;url=https%3a%2f%2fharrigan.xyz%2fposts%2fintegration-testing-with-golang%2f&amp;hashtags=go%2cdevelopment%2ctesting"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Integration Testing with Golang on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fharrigan.xyz%2fposts%2fintegration-testing-with-golang%2f&amp;title=Integration%20Testing%20with%20Golang&amp;summary=Integration%20Testing%20with%20Golang&amp;source=https%3a%2f%2fharrigan.xyz%2fposts%2fintegration-testing-with-golang%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Integration Testing with Golang on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fharrigan.xyz%2fposts%2fintegration-testing-with-golang%2f&title=Integration%20Testing%20with%20Golang"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Integration Testing with Golang on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fharrigan.xyz%2fposts%2fintegration-testing-with-golang%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Integration Testing with Golang on whatsapp" href="https://api.whatsapp.com/send?text=Integration%20Testing%20with%20Golang%20-%20https%3a%2f%2fharrigan.xyz%2fposts%2fintegration-testing-with-golang%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Integration Testing with Golang on telegram" href="https://telegram.me/share/url?text=Integration%20Testing%20with%20Golang&amp;url=https%3a%2f%2fharrigan.xyz%2fposts%2fintegration-testing-with-golang%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://harrigan.xyz/>harrigan.xyz</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>